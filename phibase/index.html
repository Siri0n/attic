<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Фи-еричная система счисления</title>
	<script type="text/javascript" src="node_modules/phibase/phibase.js"></script>
	<style>
		html{
			background-color: #eee;
			font-size: 2em;
		}
		body{
			width: 100%;
			height: 100%;
			padding: 50px;
			max-width: 1024px;
			margin: 100px auto 0px;
			text-align: center;
			background-color: #fff;
		}
		body > *{
			margin: 30px 0px;
		}
		span[contenteditable]{
			border: 0.5px dotted #aaa; 
		}
		span.pale{
			color: #aaa;
		}
	</style>
</head>
<body>
	<span>Число, равное</span>
	<div>
		<span id="rn" contenteditable>1</span>
		<span id="rslash">/</span>
		<span id="rd" contenteditable>1</span>
		<span id="qn" contenteditable>+ 0</span>
		<span id="qslash">/</span>
		<span id="qd" contenteditable>1</span>
		<span id="root">√5</span>
	</div>
	<span>в фи-еричной системе счисления имеет запись</span>
	<div>
		<span id="phi" contenteditable>1</span>
	</div>
	<script>
	var model = {
		rn: "",
		rd: "",
		qn: "",
		qd: "",
		phi: ""
	}
	Object.keys(model).forEach(function(key){
		document.getElementById(key).addEventListener("keyup", doThings);
	});
	
	function doThings(){
		updateModel();
		correctModel();
		updateDOM();
	}
	function updateModel(){
		Object.keys(model).forEach(function(key){
			model[key] = document.getElementById(key).innerText;
		})
	}

	function correctModel(){
		remove(["rn", "rd", "qn", "qd"], /[^\d+\-\s]/g);
		remove(["phi"], /[^01\(\)\.\-]/g);
		remove(["rn", "rd", "qd"], /[+\s]/g);
		remove(["rd", "qd"], /\-/g);
	}

	function calculate(direction){

	}

	function updateDOM(){
		Object.keys(model).forEach(function(key){
			if(document.getElementById(key).innerText != model[key]){
				document.getElementById(key).innerText = model[key];
			}
		})
	}

	function applyStyles(){

	}

	function remove(keys, regex){
		keys.forEach(function(key){
			model[key] = model[key].replace(regex, "");
		});
	}
	</script>
</body>
</html>